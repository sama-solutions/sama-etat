<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- 
    ================================================================
    TEMPLATE UNIFIÉ SIMPLE - SAMA_CARTE V2.1
    Une seule approche pour tous les designs
    Pas de layers complexes, structure CSS simple
    ================================================================
    -->

    <!-- TEMPLATE UNIFIÉ - Une seule structure pour tout -->
    <template id="unified_simple_card" name="Carte Unifiée Simple">
        <t t-call="website.layout">
            <div id="wrap">
                <!-- Container principal simple -->
                <div class="card-container" style="
                    min-height: 100vh;
                    padding: 20px;
                    background: #f8f9fa;
                ">
                    <!-- Titre -->
                    <h1 style="text-align: center; color: #333; margin-bottom: 30px;">
                        <i class="fa fa-id-card me-3"/>Carte de <span t-esc="member.name"/>
                    </h1>
                    
                    <!-- CARTE SIMPLE SANS BACKGROUND -->
                    <div class="membership-card" style="
                        max-width: 1200px;
                        margin: 0 auto;
                        position: relative;
                        border-radius: 25px;
                        box-shadow: 0 25px 50px rgba(0,0,0,0.2);
                        aspect-ratio: 16/9;
                        min-height: 500px;
                        background: #f8f9fa;
                    ">
                        
                        <!-- Cadre central avec background intégré -->
                        <div style="
                            position: absolute;
                            top: 50%;
                            left: 50%;
                            transform: translate(-50%, -50%);
                            width: 90%;
                            max-width: 900px;
                            border-radius: 25px;
                            padding: 40px;
                            border: 4px solid rgba(255,255,255,0.9);
                            box-shadow: 0 20px 40px rgba(0,0,0,0.7);
                            z-index: 2;
                            overflow: hidden;
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            background-image: url('/background/image/dakar_gazelles/landscape');
                            background-size: cover;
                            background-position: center;
                            background-repeat: no-repeat;
                        " t-attf-style="
                            position: absolute;
                            top: 50%;
                            left: 50%;
                            transform: translate(-50%, -50%);
                            width: 90%;
                            max-width: 900px;
                            border-radius: 25px;
                            padding: 40px;
                            border: 4px solid rgba(255,255,255,0.9);
                            box-shadow: 0 20px 40px rgba(0,0,0,0.7);
                            z-index: 2;
                            overflow: hidden;
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            background-image: url('/background/image/#{background_name or 'dakar_gazelles'}/landscape');
                            background-size: cover;
                            background-position: center;
                            background-repeat: no-repeat;
                        ">
                            <!-- Overlay léger pour lisibilité du texte -->
                            <div style="
                                position: absolute;
                                top: 0; left: 0; right: 0; bottom: 0;
                                background: rgba(0,0,0,0.5);
                                z-index: 1;
                            "/>
                            <!-- Grille intégrée dans le cadre -->
                            <div style="
                                position: relative;
                                z-index: 2;
                                display: grid;
                                grid-template-columns: auto 1fr auto;
                                grid-template-rows: auto 1fr;
                                gap: 30px;
                                align-items: start;
                                min-height: 350px;
                            ">
                                <!-- QR CODE - Coin haut-droit (taille augmentée) -->
                                <div style="
                                    grid-column: 3; 
                                    grid-row: 1;
                                    display: flex;
                                    flex-direction: column;
                                    align-items: center;
                                ">
                                    <img t-if="member.barcode_qr" 
                                         t-att-src="'data:image/png;base64,' + member.barcode_qr.decode('utf-8')" 
                                         style="
                                            width: 130px; 
                                            height: 130px; 
                                            background: white; 
                                            padding: 8px; 
                                            border-radius: 15px; 
                                            box-shadow: 0 8px 20px rgba(0,0,0,0.5);
                                            border: 3px solid rgba(255,255,255,0.9);
                                         "
                                         alt="QR Code"/>
                                    <div t-else="" style="
                                        width: 130px; 
                                        height: 130px;
                                        background: rgba(255,255,255,0.9); 
                                        color: #333;
                                        border-radius: 15px;
                                        display: flex; 
                                        align-items: center; 
                                        justify-content: center;
                                        font-size: 1.3rem; 
                                        font-weight: bold;
                                        box-shadow: 0 8px 20px rgba(0,0,0,0.5);
                                        border: 3px solid rgba(255,255,255,0.9);
                                    ">QR</div>
                                    <p style="
                                        color: white; 
                                        font-size: 0.8rem; 
                                        margin-top: 8px; 
                                        font-weight: 600;
                                        text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
                                        text-align: center;
                                    ">
                                        Scannez
                                    </p>
                                </div>
                                
                                <!-- INFORMATIONS CENTRALES -->
                                <div style="
                                    grid-column: 1 / 4; 
                                    grid-row: 2;
                                    text-align: center;
                                    display: flex;
                                    flex-direction: column;
                                    justify-content: center;
                                    align-items: center;
                                ">
                                    <h2 style="
                                        color: white; 
                                        margin-bottom: 15px; 
                                        font-size: 2.5rem; 
                                        font-weight: 700;
                                        text-shadow: 3px 3px 6px rgba(0,0,0,0.8);
                                    " t-esc="member.name"/>
                                    <p style="
                                        color: #f8f9fa; 
                                        font-size: 1.4rem; 
                                        margin-bottom: 20px; 
                                        font-weight: 600;
                                        background: rgba(255,255,255,0.1);
                                        padding: 8px 20px;
                                        border-radius: 15px;
                                        display: inline-block;
                                    " t-esc="member.membership_number"/>
                                    
                                    <div t-if="is_valid" style="
                                        background: linear-gradient(135deg, #198754, #20c997); 
                                        color: white;
                                        padding: 12px 25px; 
                                        border-radius: 25px;
                                        font-size: 1.1rem; 
                                        font-weight: 700;
                                        display: inline-block;
                                        margin-bottom: 15px;
                                        box-shadow: 0 4px 12px rgba(25, 135, 84, 0.4);
                                        text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
                                    ">
                                        <i class="fa fa-check-circle me-2"/>CARTE VALIDE
                                    </div>
                                    <div t-else="" style="
                                        background: linear-gradient(135deg, #dc3545, #fd7e14); 
                                        color: white;
                                        padding: 12px 25px; 
                                        border-radius: 25px;
                                        font-size: 1.1rem; 
                                        font-weight: 700;
                                        display: inline-block;
                                        margin-bottom: 15px;
                                        box-shadow: 0 4px 12px rgba(220, 53, 69, 0.4);
                                        text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
                                    ">
                                        <i class="fa fa-times-circle me-2"/>CARTE EXPIRÉE
                                    </div>
                                    
                                    <div style="
                                        color: #f8f9fa; 
                                        font-size: 1.1rem; 
                                        font-weight: 600;
                                        text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
                                        margin-bottom: 8px;
                                    ">
                                        Expire le <strong t-esc="member.expiration_date.strftime('%d/%m/%Y')"/>
                                    </div>
                                    <div style="
                                        color: #f8f9fa; 
                                        font-size: 1rem; 
                                        font-weight: 500;
                                        text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
                                    ">
                                        Organisation : <strong t-esc="company.name"/>
                                    </div>
                                </div>
                                
                                <!-- PHOTO - Coin haut-gauche (même niveau que QR, taille augmentée) -->
                                <div style="
                                    grid-column: 1; 
                                    grid-row: 1;
                                    display: flex;
                                    justify-content: flex-start;
                                    align-items: flex-start;
                                ">
                                    <img t-if="member.image_1920" 
                                         t-att-src="'/web/image/membership.member/' + str(member.id) + '/image_1920'" 
                                         style="
                                            width: 195px; 
                                            height: 195px;
                                            border-radius: 50%; 
                                            border: 5px solid white;
                                            object-fit: cover;
                                            box-shadow: 0 12px 30px rgba(0,0,0,0.7);
                                            filter: brightness(1.1) contrast(1.1);
                                         "
                                         alt="Photo membre"/>
                                    <div t-else="" style="
                                        width: 195px; 
                                        height: 195px;
                                        background: rgba(255,255,255,0.9); 
                                        color: #333;
                                        border-radius: 50%; 
                                        border: 5px solid white;
                                        display: flex; 
                                        align-items: center; 
                                        justify-content: center;
                                        font-size: 1.5rem; 
                                        font-weight: bold;
                                        box-shadow: 0 12px 30px rgba(0,0,0,0.7);
                                    ">PHOTO</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Navigation simple -->
                    <div style="text-align: center; margin-top: 40px;">
                        <div t-if="is_preview" style="margin-bottom: 30px;">
                            <!-- Boutons de background -->
                            <div style="margin-bottom: 15px;">
                                <h4 style="color: white; margin-bottom: 15px; text-shadow: 2px 2px 4px rgba(0,0,0,0.7);">
                                    🆼️ Tester les backgrounds
                                </h4>
                                <a t-attf-href="/member/#{member.id}/preview/unified/dakar_gazelles" style="
                                    background: #fd7e14; color: white; padding: 10px 20px; text-decoration: none; 
                                    border-radius: 8px; font-weight: 600; margin: 0 5px; font-size: 0.9rem;
                                ">
                                    🏃 Dakar Gazelles
                                </a>
                                <a t-attf-href="/member/#{member.id}/preview/unified/jokkoo" style="
                                    background: #6f42c1; color: white; padding: 10px 20px; text-decoration: none; 
                                    border-radius: 8px; font-weight: 600; margin: 0 5px; font-size: 0.9rem;
                                ">
                                    🏢 Jokkoo
                                </a>
                                <a t-attf-href="/member/#{member.id}/preview/unified/teranga_corp" style="
                                    background: #20c997; color: white; padding: 10px 20px; text-decoration: none; 
                                    border-radius: 8px; font-weight: 600; margin: 0 5px; font-size: 0.9rem;
                                ">
                                    🏛️ Teranga Corp
                                </a>
                            </div>
                            <!-- Bouton principal -->
                            <a t-attf-href="/member/#{member.id}/preview/unified/#{background_name or 'default'}" style="
                                background: #28a745; color: white; padding: 12px 25px; text-decoration: none; 
                                border-radius: 8px; font-weight: 600; margin: 0 10px;
                            ">
                                🎯 Carte Unifiée
                            </a>
                        </div>
                        <a href="/members/gallery" style="
                            background: #0d6efd; 
                            color: white; 
                            padding: 15px 30px; 
                            text-decoration: none; 
                            border-radius: 10px; 
                            font-weight: 600;
                            font-size: 1.1rem;
                            box-shadow: 0 4px 12px rgba(13, 110, 253, 0.3);
                        ">
                            <i class="fa fa-arrow-left me-2"/>Retour à la galerie
                        </a>
                    </div>
                    
                    <!-- Diagnostic simple -->
                    <div style="
                        margin-top: 40px; 
                        padding: 25px; 
                        background: rgba(255,255,255,0.9); 
                        border-radius: 15px; 
                        max-width: 1000px; 
                        margin-left: auto; 
                        margin-right: auto;
                        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                    ">
                        <h4 style="color: #333; margin-bottom: 20px;">
                            ✅ Template Unifié avec Background Dynamique
                        </h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div><strong>Structure :</strong> Grid simple 3 colonnes</div>
                            <div><strong>Photo :</strong> 200px centrée automatiquement</div>
                            <div><strong>Background :</strong> <span t-esc="background_name or 'dakar_gazelles'"/> + dégradé fallback</div>
                            <div><strong>Overlay :</strong> rgba(0,0,0,0.3) pour lisibilité</div>
                            <div><strong>CSS :</strong> Inline direct</div>
                            <div><strong>Responsive :</strong> Grid auto-adapt</div>
                        </div>
                    </div> <!-- Fin contenu principal -->
                </div>
            </div>
        </t>
    </template>

    <!-- TEMPLATE POUR PRÉVISUALISATION - Identique mais avec navigation -->
    <template id="unified_preview_card" name="Prévisualisation Unifiée">
        <t t-call="sama_carte.unified_simple_card"/>
    </template>

    <!-- TEMPLATE POUR PAGE PUBLIQUE - Identique -->
    <template id="unified_public_card" name="Page Publique Unifiée">
        <t t-call="sama_carte.unified_simple_card"/>
    </template>
</odoo>